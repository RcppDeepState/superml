<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>K-Means Trainer — KMeansTrainer • SuperML</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="K-Means Trainer — KMeansTrainer" />
<meta property="og:description" content="Trains a k-means machine learning model in R" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SuperML</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/superml_tutorial.html">Introduction to superml</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/saraswatmks/superml">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/saraswatmanish/">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>K-Means Trainer</h1>
    <small class="dont-index">Source: <a href='https://github.com/saraswatmks/superml/blob/master/R/KMeansTrainer.R'><code>R/KMeansTrainer.R</code></a></small>
    <div class="hidden name"><code>KMeansTrainer.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Trains a k-means machine learning model in R</p>
    </div>



    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Trains a unsupervised K-Means clustering algorithm. It borrows mini-batch k-means function from
ClusterR package written in c++, hence it is quite fast.</p>
    <h2 class="hasAnchor" id="public-fields"><a class="anchor" href="#public-fields"></a>Public fields</h2>

    <p><div class="r6-fields"></p><dl class='dl-horizontal'>
<dt><code>clusters</code></dt><dd><p>the number of clusters</p></dd>

<dt><code>batch_size</code></dt><dd><p>the size of the mini batches</p></dd>

<dt><code>num_init</code></dt><dd><p>number of times the algorithm will be run with different centroid seeds</p></dd>

<dt><code>max_iters</code></dt><dd><p>the maximum number of clustering iterations</p></dd>

<dt><code>init_fraction</code></dt><dd><p>percentage of data to use for the initialization centroids (applies if initializer is kmeans++ or optimal_init). Should be a float number between 0.0 and 1.0.</p></dd>

<dt><code>initializer</code></dt><dd><p>the method of initialization. One of, optimal_init, quantile_init, kmeans++ and random.</p></dd>

<dt><code>early_stop_iter</code></dt><dd><p>continue that many iterations after calculation of the best within-cluster-sum-ofsquared-error</p></dd>

<dt><code>verbose</code></dt><dd><p>either TRUE or FALSE, indicating whether progress is printed during clustering</p></dd>

<dt><code>centroids</code></dt><dd><p>a matrix of initial cluster centroids. The rows of the CENTROIDS matrix should be equal to the number of clusters and the columns should be equal to the columns of the data</p></dd>

<dt><code>tol</code></dt><dd><p>a float number. If, in case of an iteration (iteration &gt; 1 and iteration &lt; max_iters) "tol" is greater than the squared norm of the centroids, then kmeans has converged</p></dd>

<dt><code>tol_optimal_init</code></dt><dd><p>tolerance value for the ’optimal_init’ initializer. The higher this value is, the far appart from each other the centroids are.</p></dd>

<dt><code>seed</code></dt><dd><p>integer value for random number generator (RNG)</p></dd>

<dt><code>model</code></dt><dd><p>use for internal purpose</p></dd>

<dt><code>max_clusters</code></dt><dd><p>either a numeric value, a contiguous or non-continguous numeric vector specifying the cluster search space</p></dd>

</dl><p></div></p>
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
<h3>Public methods</h3>

<ul>
<li><p><a href='#method-new'><code>KMeansTrainer$new()</code></a></p></li>
<li><p><a href='#method-fit'><code>KMeansTrainer$fit()</code></a></p></li>
<li><p><a href='#method-predict'><code>KMeansTrainer$predict()</code></a></p></li>
<li><p><a href='#method-clone'><code>KMeansTrainer$clone()</code></a></p></li>
</ul>
<p><hr>
<a id="method-new"></a></p><h3>Method <code>new()</code></h3>

<h3>Usage</h3>
<p><div class="r"></p><pre>KMeansTrainer$new(
  clusters,
  batch_size = 10,
  num_init = 1,
  max_iters = 100,
  init_fraction = 1,
  initializer = "kmeans++",
  early_stop_iter = 10,
  verbose = FALSE,
  centroids = NULL,
  tol = 1e-04,
  tol_optimal_init = 0.3,
  seed = 1,
  max_clusters = NA
)</pre><p></div></p>

<h3>Arguments</h3>
<p><div class="arguments"></p><dl class='dl-horizontal'>
<dt><code>clusters</code></dt><dd><p>numeric, When building the vocabulary ignore terms that have a document frequency strictly lower than the given threshold, value lies between 0 and 1.</p></dd>

<dt><code>batch_size</code></dt><dd><p>nuemric, When building the vocabulary ignore terms that have a document frequency strictly higher than the given threshold, value lies between 0 and 1.</p></dd>

<dt><code>num_init</code></dt><dd><p>integer, use top features sorted by count to be used in bag of words matrix.</p></dd>

<dt><code>max_iters</code></dt><dd><p>character, regex expression to use for text cleaning.</p></dd>

<dt><code>init_fraction</code></dt><dd><p>list, a list of stopwords to use, by default it uses its inbuilt list of standard stopwords</p></dd>

<dt><code>initializer</code></dt><dd><p>character, splitting criteria for strings, default: " "</p></dd>

<dt><code>early_stop_iter</code></dt><dd><p>continue that many iterations after calculation of the best within-cluster-sum-ofsquared-error</p></dd>

<dt><code>verbose</code></dt><dd><p>either TRUE or FALSE, indicating whether progress is printed during clustering</p></dd>

<dt><code>centroids</code></dt><dd><p>a matrix of initial cluster centroids. The rows of the CENTROIDS matrix should be equal to the number of clusters and the columns should be equal to the columns of the data</p></dd>

<dt><code>tol</code></dt><dd><p>a float number. If, in case of an iteration (iteration &gt; 1 and iteration &lt; max_iters) "tol" is greater than the squared norm of the centroids, then kmeans has converged</p></dd>

<dt><code>tol_optimal_init</code></dt><dd><p>tolerance value for the ’optimal_init’ initializer. The higher this value is, the far appart from each other the centroids are.</p></dd>

<dt><code>seed</code></dt><dd><p>integer value for random number generator (RNG)</p></dd>

<dt><code>max_clusters</code></dt><dd><p>either a numeric value, a contiguous or non-continguous numeric vector specifying the cluster search space</p></dd>

</dl><p></div></p>
<h3>Details</h3>
<p>Create a new `KMeansTrainer` object.</p>

<h3>Returns</h3>
<p>A `KMeansTrainer` object.</p>
<h3>Examples</h3>
<p><div class="r example copy"></p><pre>data &lt;- rbind(replicate(20, rnorm(1e4, 2)),
             replicate(20, rnorm(1e4, -1)),
             replicate(20, rnorm(1e4, 5)))
km_model &lt;- KMeansTrainer$new(clusters=2, batch_size=30, max_clusters=6)
</pre><p></div></p>

<p><hr>
<a id="method-fit"></a></p><h3>Method <code>fit()</code></h3>

<h3>Usage</h3>
<p><div class="r"></p><pre>KMeansTrainer$fit(X, y = NULL, find_optimal = FALSE)</pre><p></div></p>

<h3>Arguments</h3>
<p><div class="arguments"></p><dl class='dl-horizontal'>
<dt><code>X</code></dt><dd><p>data.frame or matrix containing features</p></dd>

<dt><code>y</code></dt><dd><p>NULL only kept here for superml's standard way</p></dd>

<dt><code>find_optimal</code></dt><dd><p>logical, to find the optimal clusters automatically</p></dd>

</dl><p></div></p>
<h3>Details</h3>
<p>Trains the KMeansTrainer model</p>

<h3>Returns</h3>
<p>NULL</p>
<h3>Examples</h3>
<p><div class="r example copy"></p><pre>data &lt;- rbind(replicate(20, rnorm(1e4, 2)),
             replicate(20, rnorm(1e4, -1)),
             replicate(20, rnorm(1e4, 5)))
km_model &lt;- KMeansTrainer$new(clusters=2, batch_size=30, max_clusters=6)
km_model$fit(data, find_optimal = FALSE)
</pre><p></div></p>

<p><hr>
<a id="method-predict"></a></p><h3>Method <code><a href='https://rdrr.io/r/stats/predict.html'>predict()</a></code></h3>

<h3>Usage</h3>
<p><div class="r"></p><pre>KMeansTrainer$predict(X)</pre><p></div></p>

<h3>Arguments</h3>
<p><div class="arguments"></p><dl class='dl-horizontal'>
<dt><code>X</code></dt><dd><p>data.frame or matrix</p></dd>

</dl><p></div></p>
<h3>Details</h3>
<p>Returns the prediction on test data</p>

<h3>Returns</h3>
<p>a vector of predictions</p>
<h3>Examples</h3>
<p><div class="r example copy"></p><pre>data &lt;- rbind(replicate(20, rnorm(1e4, 2)),
             replicate(20, rnorm(1e4, -1)),
             replicate(20, rnorm(1e4, 5)))
km_model &lt;- KMeansTrainer$new(clusters=2, batch_size=30, max_clusters=6)
km_model$fit(data, find_optimal = FALSE)
predictions &lt;- km_model$predict(data)
</pre><p></div></p>

<p><hr>
<a id="method-clone"></a></p><h3>Method <code>clone()</code></h3>
<p>The objects of this class are cloneable with this method.</p><h3>Usage</h3>
<p><div class="r"></p><pre>KMeansTrainer$clone(deep = FALSE)</pre><p></div></p>

<h3>Arguments</h3>
<p><div class="arguments"></p><dl class='dl-horizontal'>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p></dd>

</dl><p></div></p>



    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `KMeansTrainer$new`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span>(<span class='fl'>20</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>1e4</span>, <span class='fl'>2</span>)),
             <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span>(<span class='fl'>20</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>1e4</span>, -<span class='fl'>1</span>)),
             <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span>(<span class='fl'>20</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>1e4</span>, <span class='fl'>5</span>)))
<span class='no'>km_model</span> <span class='kw'>&lt;-</span> <span class='no'>KMeansTrainer</span>$<span class='fu'>new</span>(<span class='kw'>clusters</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>batch_size</span><span class='kw'>=</span><span class='fl'>30</span>, <span class='kw'>max_clusters</span><span class='kw'>=</span><span class='fl'>6</span>)

<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `KMeansTrainer$fit`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span>(<span class='fl'>20</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>1e4</span>, <span class='fl'>2</span>)),
             <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span>(<span class='fl'>20</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>1e4</span>, -<span class='fl'>1</span>)),
             <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span>(<span class='fl'>20</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>1e4</span>, <span class='fl'>5</span>)))
<span class='no'>km_model</span> <span class='kw'>&lt;-</span> <span class='no'>KMeansTrainer</span>$<span class='fu'>new</span>(<span class='kw'>clusters</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>batch_size</span><span class='kw'>=</span><span class='fl'>30</span>, <span class='kw'>max_clusters</span><span class='kw'>=</span><span class='fl'>6</span>)
<span class='no'>km_model</span>$<span class='fu'>fit</span>(<span class='no'>data</span>, <span class='kw'>find_optimal</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='message'>Using 2 clusters to learn from data</span></div><div class='input'>
<span class='co'>## ------------------------------------------------</span>
<span class='co'>## Method `KMeansTrainer$predict`</span>
<span class='co'>## ------------------------------------------------</span>

<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span>(<span class='fl'>20</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>1e4</span>, <span class='fl'>2</span>)),
             <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span>(<span class='fl'>20</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>1e4</span>, -<span class='fl'>1</span>)),
             <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span>(<span class='fl'>20</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>1e4</span>, <span class='fl'>5</span>)))
<span class='no'>km_model</span> <span class='kw'>&lt;-</span> <span class='no'>KMeansTrainer</span>$<span class='fu'>new</span>(<span class='kw'>clusters</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>batch_size</span><span class='kw'>=</span><span class='fl'>30</span>, <span class='kw'>max_clusters</span><span class='kw'>=</span><span class='fl'>6</span>)
<span class='no'>km_model</span>$<span class='fu'>fit</span>(<span class='no'>data</span>, <span class='kw'>find_optimal</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='message'>Using 2 clusters to learn from data</span></div><div class='input'><span class='no'>predictions</span> <span class='kw'>&lt;-</span> <span class='no'>km_model</span>$<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>data</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#details">Details</a></li>
      <li><a href="#public-fields">Public fields</a></li>
      <li><a href="#methods">Methods</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Manish Saraswat.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


